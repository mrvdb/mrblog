{
  "_id": "940370852",
  "_thread": "1430919137",
  "_parent": null,
  "name": "Simon Vass",
  "email": "svass@etech.ug",
  "message": "<p>Hi Marcel,</p><p>This looks really good as I am looking to do the same functionality and publish a OpenERP partner list as an ldap database.</p><p>I followed the OpenLDAP FAQ and your instructions but got stuck somewhere.</p><p>I have created an SQL file which contains your instructions.<br><code><br>INSERT INTO ldap_oc_mappings(name,keytbl,keycol)<br>    VALUES('inetOrgPerson','ldap_inetOrgPerson','id');<br>INSERT INTO ldap_oc_mappings(name,keytbl,keycol)<br>    VALUES('organizationalUnit','ldap_ organizationalUnit','id');<br>CREATE OR REPLACE VIEW ldap_inetorgperson AS<br>  SELECT<br>    a.id,<br>    btrim((COALESCE(a.firstname,'')||' ') || a.lastname) AS cn,<br>    btrim((COALESCE(a.firstname,'')||' ') || a.lastname) AS displayname,<br>    a.phone AS telephonenumber,<br>    a.lastname AS sn,<br>    a.firstname AS givenname,<br>    a.fax AS facsimiletelephonenumber,<br>    a.mobile,<br>    a.private_phone AS homephone,<br>    lower(a.email) AS mail,<br>    a.street,<br>    a.zip AS postalcode<br>  FROM res_partner_address a<br>  WHERE<br>    a.email  ''  AND<br>    a.email  '\"' AND<br>    a.type  =  'contact';<br>INSERT INTO ldap_organizationalUnit(name) VALUES ('addressbook');<br>INSERT INTO ldap_attr_mappings(<br>        oc_map_id,name,sel_expr,from_tbls,join_where<br>    )<br>VALUES(<br>    1,'telephoneNumber','telephoneNumber',ldap_inetOrgPerson,'1=1'<br>);<br>CREATE OR REPLACE VIEW ldap_entries AS<br>   SELECT<br>     0 AS id,<br>     'ou=addressbook,dc=xxxxx,dc=local' AS dn,<br>     2 AS oc_map_id,<br>     0 AS parent,<br>     0 AS keyval<br>    UNION<br>   SELECT<br>     ldap_inetorgperson.id,<br>     ('cn=' || ldap_inetorgperson.cn) ||<br>     ',ou=addressbook,dc=xxxxx,dc=local' AS dn,<br>     1 AS oc_map_id,<br>     0 AS parent,<br>     ldap_inetorgperson.id AS keyval<br>   FROM ldap_inetorgperson;<br></code><br>but it throws up an error;<br><code><br>ERROR:  null value in column \"expect_return\" violates not-null constraint<br>ERROR:  null value in column \"expect_return\" violates not-null constraint<br>ERROR:  column a.firstname does not exist<br>LINE 4:     btrim((COALESCE(a.firstname,'')||' ') || a.lastname) AS ...<br>                            ^<br>ERROR:  relation \"ldap_organizationalunit\" does not exist<br>ERROR:  column \"ldap_inetorgperson\" does not exist<br>LINE 5:     1,'telephoneNumber','telephoneNumber',ldap_inetOrgPerson...<br>                                                  ^<br>ERROR:  relation \"ldap_inetorgperson\" does not exist<br>etechadmin@mail:~/ldap-openerp$ psql -h localhost -d fbw -U openerp &lt; create-openerpdb.sql <br>Password for user openerp: <br>ERROR:  null value in column \"expect_return\" violates not-null constraint<br>ERROR:  null value in column \"expect_return\" violates not-null constraint<br>ERROR:  column a.firstname does not exist<br>LINE 4:     btrim((COALESCE(a.firstname,'')||' ') || a.lastname) AS ...<br>                            ^<br>ERROR:  relation \"ldap_organizationalunit\" does not exist<br>ERROR:  column \"ldap_inetorgperson\" does not exist<br>LINE 5:     1,'telephoneNumber','telephoneNumber',ldap_inetOrgPerson...<br>                                                  ^<br></code><br>From my basic understanding I don't see where ldap_organizationalunit is created? Did I miss a step?<br>~</p>",
  "date": "2010-10-26T13:40:25Z",
  "ip": "41.210.162.90",
  "spam": "false",
  "deleted": "false"
}
