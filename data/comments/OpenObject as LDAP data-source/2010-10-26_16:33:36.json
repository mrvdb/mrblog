{
  "_id": "940370855",
  "_thread": "1430919137",
  "_parent": null,
  "name": "Simon Vass",
  "email": "svass@etech.ug",
  "message": "<p>Ok, I have made some changes. I realised I was trying to map columns that did not exist in my version of OpenERP so have modified the mapping slightly.</p><p><code><br>INSERT INTO ldap_oc_mappings(name,keytbl,keycol,expect_return) VALUES('inetOrgPerson','ldap_inetOrgPerson','id',0);<br><br></code><code>INSERT INTO ldap_oc_mappings(name,keytbl,keycol,expect_return) VALUES('organizationalUnit','ldap_organizationalUnit','id',0)</code>;</p><p><code>CREATE OR REPLACE VIEW ldap_inetorgperson AS<br>  SELECT<br>    a.id,<br>    a.name AS cn,<br>    a.name AS displayname,<br>    a.phone AS telephonenumber,<br>    a.name AS sn,<br>    a.name AS givenname,<br>    a.fax AS facsimiletelephonenumber,<br>    a.mobile,<br>    lower(a.email) AS mail,<br>    a.street,<br>    a.zip AS postalcode<br>  FROM res_partner_address a<br>  WHERE<br>    a.email  ''  AND<br>    a.email  '\"' AND<br>    a.type  =  'contact';</code></p><p><code><br>CREATE TABLE ldap_organizationalUnit<br>(<br>id serial NOT NULL,<br>\"name\" character(255),<br>CONSTRAINT \"ldap_organizationalUnit_pkey\" PRIMARY KEY (id)<br>)<br></code></p><p><code>INSERT INTO ldap_organizationalUnit(name) VALUES ('addressbook');<br></code><br><code>INSERT INTO ldap_attr_mappings(oc_map_id,name,sel_expr,from_tbls,join_where,expect_return) VALUES(1,'telephoneNumber','telephoneNumber',ldap_inetOrgPerson,'1=1',0);<br></code><br><code><br>CREATE OR REPLACE VIEW ldap_entries AS<br>   SELECT<br>     0 AS id,<br>     'ou=addressbook,dc=fbwgroup,dc=local' AS dn,<br>     2 AS oc_map_id,<br>     0 AS parent,<br>     0 AS keyval<br>    UNION<br>   SELECT<br>     ldap_inetorgperson.id,<br>     ('cn=' || ldap_inetorgperson.cn) ||<br>     ',ou=addressbook,dc=fbwgroup,dc=local' AS dn,<br>     1 AS oc_map_id,<br>     0 AS parent,<br>     ldap_inetorgperson.id AS keyval<br>   FROM ldap_inetOrgPerson;<br></code><br>~                                                                                              <br>~                                                                                              <br>~</p><p>I now get the following errors;</p><p><code>etechadmin@mail:~/ldap-openerp$ psql -h localhost -d fbw -U openerp &lt; create-openerpdb.sql <br>Password for user openerp: <br>INSERT 0 1<br>INSERT 0 1<br>ERROR:  schema \"a\" does not exist<br>ERROR:  syntax error at or near \"INSERT\"<br>LINE 7: INSERT INTO ldap_organizationalUnit(name) VALUES ('addressbo...<br>        ^<br>ERROR:  column \"ldap_inetorgperson\" does not exist<br>LINE 1: ...urn) VALUES(1,'telephoneNumber','telephoneNumber',ldap_inetO...</code></p>",
  "date": "2010-10-26T16:33:36Z",
  "ip": "41.210.162.90",
  "spam": "false",
  "deleted": "false"
}
